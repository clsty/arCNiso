#!/bin/bash
# 此脚本可启用 archlinuxcn 仓库源及其密钥；并且在设计上使得即使中途失败，也可多次执行。

function addcn {
	echo "下面开始添加 archlinuxcn 仓库源及其密钥，此过程耗时约 1 至 6 分钟，在虚拟机中可能较慢。"
	systemctl start pacman-init
	echo '
	[archlinuxcn]
	Include = /etc/pacman.d/archlinuxcn-mirrorlist' > /etc/pacman.d/archlinuxcn.conf
	sleep 3
	pacman -Sy archlinuxcn-keyring --noconfirm;
}

case $(whoami) in
	root)addcn;;
	*)sudo "$0";;
esac
